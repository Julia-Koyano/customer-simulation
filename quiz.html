<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>æ¥å®¢ã‚¯ã‚¤ã‚º</title>
  <link rel="stylesheet" href="style.css">
  <style>
    #quiz-switch {
      display: flex;
      justify-content: center;
      gap: 16px;
      margin-bottom: 20px;
    }

    #quiz-switch button {
      padding: 8px 16px;
      font-size: 14px;
      border-radius: 4px;
      background-color: #3498db;
      color: white;
      border: none;
      cursor: pointer;
    }

    #quiz-switch button.active {
      background-color: #ff00bf;
      font-weight: bold;
    }
  </style>
</head>
<body class="quiz-page">

<div class="background">
  <div class="top-stripes"></div>

  <div class="back-to-home">
    <a href="index.html" class="home-button">
      <img src="bookmark.png" alt="Home" />
      <span class="home-label">HOME</span>
    </a>
  </div>

  <div class="header">
    <h1>æ¥å®¢ã‚¯ã‚¤ã‚º</h1>
    <p>You can practice customer service phrases in quiz format.</p>
  </div>

  <!-- åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ -->
  <div id="quiz-switch">
    <button id="show-service" class="active">æ¥å®¢ã‚¯ã‚¤ã‚º</button>
    <button id="show-listening">ãƒªã‚¹ãƒ‹ãƒ³ã‚°ã‚¯ã‚¤ã‚º</button>
  </div>

  <div id="quiz"></div>
  <button id="resetBtn" style="display:none;">Reset</button>

  <div class="bottom-stripes"></div>
</div>

<script>
const serviceData = [
  {
    q: 'ğŸ‘¤ ãŠå®¢ã•ã‚“ï¼šã€Œã‚»ãƒƒãƒˆã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿã€',
    en: 'Customer: "Do you have any sets?"',
    options: [
      { ja: 'ã¯ã„ã€ãƒ‰ãƒªãƒ³ã‚¯ã®ã¿ã¨ãªã‚Šã¾ã™', en:'Yes, drinks only.' },
      { ja: 'ãƒ¢ãƒ¼ãƒ‹ãƒ³ã‚°ã‚»ãƒƒãƒˆï¼ˆ10æ™‚30åˆ†ã¾ã§ï¼‰ã¨ãƒŸãƒ©ãƒã‚µãƒ³ãƒ‰ã‚»ãƒƒãƒˆãŒã”ã–ã„ã¾ã™', en: 'We have morning sets (until 10:30) and Milano sandwich sets.' },
      { ja: 'ã‚»ãƒƒãƒˆã¯ã‚„ã£ã¦ã„ã¾ã›ã‚“', en: 'We do not offer sets.' }
    ],
    correct: 1,
    explanation: {ja:'ãƒ¢ãƒ¼ãƒ‹ãƒ³ã‚°ã‚»ãƒƒãƒˆã¨ãƒŸãƒ©ãƒã‚µãƒ³ãƒ‰ã‚»ãƒƒãƒˆãŒã‚ã‚‹ã“ã¨ã‚’æ¡ˆå†…ã—ã¾ã™ã€‚',en:'Let the customer know that we have a morning set (until 10:30) and a Milano sandwich set.'},
    audio: '58 (9).wav'
  },
  {
    q: 'ğŸ‘¤ ãŠå®¢ã•ã‚“ï¼šã€ŒAãƒ¢ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€',
    en: 'Customer: "I\'ll have the A Morning Set, please."',
    options: [
      { ja: 'ãƒŸãƒ©ãƒã‚µãƒ³ãƒ‰Aã§ã™ã­', en:  "So, that's Milano Sandwich A, correct?"},
      { ja: 'ãŠé£²ã¿ç‰©ã¯ã„ã‹ãŒãªã•ã„ã¾ã™ã‹ï¼Ÿ', en: 'What would you like to drink?' },
      { ja: 'ã‚µã‚¤ã‚ºã¯ã„ã‹ãŒãªã•ã„ã¾ã™ã‹ï¼Ÿ', en: 'What size would you like?' }
    ],
    correct: 1,
    explanation:  {ja:'ãƒ¢ãƒ¼ãƒ‹ãƒ³ã‚°ã‚»ãƒƒãƒˆã¯é£²ã¿ç‰©ã®é¸æŠãŒå¿…è¦ãªã®ã§ã€é£²ã¿ç‰©ã‚’ç¢ºèªã—ã¾ã™ã€‚',en:'The morning set comes with a drink, so we ask which one the customer would like.'},
    audio: '58 (10).wav'
  },
  {
    q: 'ğŸ‘¤ ãŠå®¢ã•ã‚“ï¼šã€Œã‚¸ãƒ£ãƒ¼ãƒãƒ³ãƒ‰ãƒƒã‚°ã®ã‚»ãƒƒãƒˆã§ã€',
    en: 'Customer: "I\'ll have the German dog set."',
    options: [
      { ja: 'ã‹ã—ã“ã¾ã‚Šã¾ã—ãŸ', en: 'Certainly.' },
      { ja: 'ãŠé£²ã¿ç‰©ã¯ã„ã‹ãŒãªã•ã„ã¾ã™ã‹ï¼Ÿ', en: 'What would you like to drink?' },
      { ja: 'ãã¡ã‚‰ã¯å˜å“ã®ã¿ã¨ãªã‚Šã¾ã™ãŒã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ', en: 'That dish is available Ã  la carte only. Is that alright?' }
    ],
    correct: 2,
    explanation:  {ja:'ã‚¸ãƒ£ãƒ¼ãƒãƒ³ãƒ‰ãƒƒã‚°ã¯ã‚»ãƒƒãƒˆã«ã§ããªã„ã®ã§ã€ç¢ºèªã‚’å–ã‚Šã¾ã™',en:'German dog is not available as a set, so we need to confirm.'},
    audio: '58 (11).wav'
  }
];

const listeningData = [
  {
    audio: '58 (20).wav',
    options: [
      'ãƒ«ã‚¤ãƒœã‚¹ãƒ†ã‚£ãƒ¼ãã ã•ã„',
      'ã‚¢ã‚¤ã‚¹ã‚³ãƒ¼ãƒ’ãƒ¼ãã ã•ã„',
      'ã‚¢ã‚¤ã‚¹ãƒ†ã‚£ãƒ¼ãã ã•ã„'
    ],
    correct: 2
  },
  {
    audio: '58 (21).wav',
    options: [
      'Bãƒ¢ãƒ¼ãƒ‹ãƒ³ã‚°ãã ã•ã„',
      'Bã‚µãƒ³ãƒ‰ãã ã•ã„',
      'Aãƒ¢ãƒ¼ãƒ‹ãƒ³ã‚°ãã ã•ã„'
    ],
    correct: 0
  },
  {
    audio: '58 (22).wav',
    options: [
      'Sã‚¢ã‚¤ã‚¹ãŠé¡˜ã„ã—ã¾ã™',
      'Lã‚¢ã‚¤ã‚¹ãŠé¡˜ã„ã—ã¾ã™',
      'Ğœã‚¢ã‚¤ã‚¹ãŠé¡˜ã„ã—ã¾ã™'
    ],
    correct: 2
  }
];

const container = document.getElementById('quiz');
const resetBtn = document.getElementById('resetBtn');

function renderQuiz() {
  container.innerHTML = '';
  let correctCount = 0;
  serviceData.forEach((item, i) => {
    const div = document.createElement('div');
    div.className = 'question';

    const p = document.createElement('p');
    p.textContent = item.q;
    div.appendChild(p);

    if (item.en) {
      const en = document.createElement('p');
      en.textContent = item.en;
      en.style.fontStyle = 'italic';
      en.style.color = '#555';
      div.appendChild(en);
    }

    item.options
      .map((opt, index) => ({ text: opt.ja, en: opt.en, index }))
      .sort(() => Math.random() - 0.5)
      .forEach(({ text, en, index }) => {
        const btn = document.createElement('button');
        btn.innerHTML = `${text}<br><small style="color:#555;">${en}</small>`;
        btn.onclick = () => {
          const allBtns = div.querySelectorAll('button');
          allBtns.forEach(b => b.disabled = true);
          btn.classList.add(index === item.correct ? 'correct' : 'wrong');
          btn.innerHTML += index === item.correct ? ' âœ“' : ' âœ—';
          if (index === item.correct) correctCount++;

          const explanation = document.createElement('div');
          explanation.className = 'explanation';
          explanation.innerHTML = `ğŸ“ ${item.explanation.ja}<br><small style="color: #555;">${item.explanation.en}</small>`;
          div.appendChild(explanation);

          const audio = document.createElement('audio');
          audio.src = 'voice/' + item.audio;
          audio.id = `audio${i}`;
          div.appendChild(audio);

          const playBtn = document.createElement('button');
          playBtn.textContent = 'ğŸ”Š æ­£è§£ã®éŸ³å£°ã‚’èã';
          playBtn.className = 'audio-btn';
          playBtn.onclick = () => document.getElementById(`audio${i}`).play();
          div.appendChild(playBtn);

          if (i === serviceData.length - 1) {
            resetBtn.style.display = 'block';
            const scoreMsg = document.createElement('p');
            scoreMsg.style.fontWeight = 'bold';
            scoreMsg.style.fontSize = '18px';
            scoreMsg.style.marginTop = '24px';
            scoreMsg.textContent = `${serviceData.length}å•ä¸­${correctCount}å•æ­£è§£ã§ã—ãŸï¼`;
            div.appendChild(scoreMsg);
          }
        };
        div.appendChild(btn);
      });
    container.appendChild(div);
  });
}

function renderListeningQuiz() {
  container.innerHTML = '';

  // èª¬æ˜æ–‡
  const intro = document.createElement('p');
  intro.innerHTML = 'ğŸ§ <strong>éŸ³å£°ã‚’ãã„ã¦ã€åŒã˜å†…å®¹ã®é¸æŠè‚¢ã‚’é¸ã¼ã†</strong><br><small>Listen to the audio and choose the matching sentence.</small>';
  intro.style.textAlign = 'center';
  intro.style.fontWeight = 'bold';
  intro.style.marginBottom = '24px';
  container.appendChild(intro);

  let correctCount = 0;
  let answeredCount = 0;

  listeningData.forEach((item, i) => {
    const div = document.createElement('div');
    div.className = 'question';

    const audio = document.createElement('audio');
    audio.src = 'voice/' + item.audio;
    audio.id = `listenaudio${i}`;
    div.appendChild(audio);

    const playBtn = document.createElement('button');
    playBtn.textContent = 'ğŸ”Š éŸ³å£°ã‚’èã';
    playBtn.className = 'audio-btn';
    playBtn.onclick = () => document.getElementById(`listenaudio${i}`).play();
    div.appendChild(playBtn);

// ãƒ©ãƒ³ãƒ€ãƒ ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä»˜ãé¸æŠè‚¢ã®ç”Ÿæˆ
const randomizedOptions = item.options.map((text, index) => ({ text, index }))
                                     .sort(() => Math.random() - 0.5);

randomizedOptions.forEach(({ text, index }) => {
  const btn = document.createElement('button');
  btn.textContent = text;
  btn.onclick = () => {
    const allBtns = div.querySelectorAll('button');
    allBtns.forEach(b => b.disabled = true);
    btn.classList.add(index === item.correct ? 'correct' : 'wrong');
    btn.innerHTML += index === item.correct ? ' âœ“' : ' âœ—';

    if (index === item.correct) correctCount++;

    // æœ€å¾Œã®å•é¡Œã®å¾Œã«ã‚¹ã‚³ã‚¢è¡¨ç¤º
    if (i === listeningData.length - 1) {
      const scoreMsg = document.createElement('p');
      scoreMsg.style.fontWeight = 'bold';
      scoreMsg.style.fontSize = '18px';
      scoreMsg.style.marginTop = '24px';
      scoreMsg.style.textAlign = 'center';
      scoreMsg.textContent = `${listeningData.length}å•ä¸­${correctCount}å•æ­£è§£ã§ã—ãŸï¼`;
      container.appendChild(scoreMsg);

        // â† ã“ã“ã§ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
      resetBtn.style.display = 'block';
    }
  };
  div.appendChild(btn);
});

    container.appendChild(div);
  });
}

// åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã®å‹•ä½œ
const showServiceBtn = document.getElementById('show-service');
const showListeningBtn = document.getElementById('show-listening');

showServiceBtn.addEventListener('click', () => {
  showServiceBtn.classList.add('active');
  showListeningBtn.classList.remove('active');
  resetBtn.style.display = 'none';
  renderQuiz();
});

showListeningBtn.addEventListener('click', () => {
  showListeningBtn.classList.add('active');
  showServiceBtn.classList.remove('active');
  resetBtn.style.display = 'none';
  renderListeningQuiz();
});

// ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³
resetBtn.onclick = () => {
  if (showServiceBtn.classList.contains('active')) {
    renderQuiz();
  } else {
    renderListeningQuiz();
  }
  resetBtn.style.display = 'none';
};

// åˆæœŸè¡¨ç¤º
renderQuiz();
</script>
</body>
</html>
